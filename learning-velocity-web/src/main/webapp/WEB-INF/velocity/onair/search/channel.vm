#parse("/velocity/onair/common/menu.vm") 


<h3 class="screen_out">방금 그 곡</h3>
<input id="standardStartDate" type="hidden"  value="$!{command.searchSDate}">
<input id="standardEndDate" type="hidden"  value="$!{command.searchEDate}">

<form id="searchChannelForm" name="searchForm" action="/onair/search/channel" method="get">
	<input type="hidden" name="channelIds" value="${command.channelIdsToString()}">
	<input type="hidden" name="radioChannelType" value="$!{command.radioChannelType}">
	<input type="hidden" name="tvChannelType" value="$!{command.tvChannelType}">

	
<div class="now_detail now_option">
	<strong class="screen_out">옵션 선택</strong>
	#parse("/velocity/onair/common/searchMenu.vm")
	<h4 class="screen_out">채널 선택</h4>
	<a href="/onair/timeline" class="btn_now btn_live">실시간 보기</a>
	<div class="detail_option detail_channel">
		<p class="txt_desc">채널을 선택해주세요 (중복선택 가능)</p>
		
		
		#set($channelCount = 0)
        #set($preMediaType = "")
        #foreach($channel in $channelList)
        	#set($checked = "")
        	#foreach($selectedChannel in $command.channelIds)
        		#if($selectedChannel == ${channel.channelId})
        			#set($checked = "class='on'")
        			#break
        		#end
			#end
			
        #if($channelCount == 0)
        		
        <strong class="tit_now">TV</strong>
        <ul class="list_chice">
        	<li #if("$!{command.tvChannelType}" =="1" || ("$!{command.tvChannelType}" =="" && "$!{command.radioChannelType}" =="" && "${command.channelIdsToString()}" == ""))class="on"#end>
        		<a href="#none" class="btn_now" id="tvChannelType">TV전체</a>
        	</li> <!-- 선택시 li에 on클래스 추가 -->
        #end
        	
        #if($channelCount != 0 && $preMediaType != ${channel.mediaType})
        </ul>
        <strong class="tit_now">라디오</strong>
        <ul class="list_chice">
        	<li #if("$!{command.radioChannelType}" =="4" || ("$!{command.tvChannelType}" =="" && "$!{command.radioChannelType}" =="" && "${command.channelIdsToString()}" == ""))class="on"#end>
        		<a href="#none" class="btn_now" id="radioChannelType">Radio전체</a>
        	</li> <!-- 선택시 li에 on클래스 추가 -->
        #end
        	
        	<li $checked>
        		<input type="hidden" value="${channel.channelId}">
        		<a href="#none" class="btn_now" id="channelId_${channel.channelId}" data-channelType="channelType_$!{channel.mediaType}" #if("${channel.mediaType}" == "4") title="${channel.frequency}"#end>${channel.channelName}</a>
        	</li>							
        	
        	#set($channelCount = $channelCount +1)
        	#set($preMediaType = ${channel.mediaType})
        #end
		</ul>
				
		<div class="opt_date">
						
			<strong class="tit_now">날짜</strong>
			<ul id="titDateList" class="list_option">
				<li #if($StringUtils.equals("$!{command.searchDueType}","today"))class="on"#end>
					<input type="radio" name="searchDueType" value="today" class="screen_out" id="sh_t1" onclick="daum.Music.Onair.setSearchDate('sh_t1','today','searchChannelForm');" #if($StringUtils.equals("$!{command.searchDueType}","today"))checked#end>
					<label class="btn_now btn_today" for="sh_t1">오늘</label>	
				</li>
				<li #if($StringUtils.equals("$!{command.searchDueType}","week"))class="on"#end>
					<input type="radio" name="searchDueType" value="week" class="screen_out" id="sh_t2" onclick="daum.Music.Onair.setSearchDate('sh_t2','week','searchChannelForm');" #if($StringUtils.equals("$!{command.searchDueType}","week"))checked#end>
					<label class="btn_now btn_day7" for="sh_t2">7일</label>	
				</li>
				<li #if($StringUtils.equals("$!{command.searchDueType}","day15"))class="on"#end>
					<input type="radio" name="searchDueType" value="day15" class="screen_out" id="sh_t3" onclick="daum.Music.Onair.setSearchDate('sh_t3','day15','searchChannelForm');" #if($StringUtils.equals("$!{command.searchDueType}","day15"))checked#end>
					<label class="btn_now btn_day15" for="sh_t3">15일</label>
				</li>
				<li #if($StringUtils.equals("$!{command.searchDueType}","day30"))class="on"#end>
					<input type="radio" name="searchDueType" value="day30" class="screen_out" id="sh_t4" onclick="daum.Music.Onair.setSearchDate('sh_t4','day30','searchChannelForm');" #if($StringUtils.equals("$!{command.searchDueType}","day30"))checked#end>
					<label class="btn_now btn_month" for="sh_t4">한달</label>
				</li>
				<li class="screen_out">
					##<button type="button" class="btn_now">기간</button>
					<input type="radio" name="searchDueType" value="custom" class="" id="sh_t5" onclick="daum.Music.Onair.setSearchDate('sh_t5','custom','searchChannelForm');" #if($StringUtils.equals("$!{command.searchDueType}","custom"))checked#end>
					<label class="btn_now" for="sh_t5">기간</label>
				</li>
				
			</ul>
			<label for="dateStart" class="screen_out">조회 시작일</label>
			<input type="text" id="dateStart" name="searchSDate" class="tf_date" readonly value="$CheckDate.makeReleaseDate($!{command.searchSDate})">
			<div class="date_cont">
				<a href="#none" class="btn_now link_calendar" onclick="calendarLayer.toggle('start');return false;">달력 보기</a>
				<div id="startCalwrap" class="calendar_comm"> <!-- 활성화시 display:block -->
					
				</div>
			</div>
			<span class="txt_inclusive">-</span>
			<label for="dateEnd" class="screen_out">조회 종료일</label>
			<input type="text" id="dateEnd" name="searchEDate" class="tf_date" readonly value="$CheckDate.makeReleaseDate($!{command.searchEDate})">
			<div class="date_cont">
				<a href="#none" class="btn_now link_calendar" onclick="calendarLayer.toggle('end');return false;">달력 보기</a>
				<div id="endCalwrap" class="calendar_comm"> <!-- 활성화시 display:block -->
				</div>
			</div>
			
			
			
			<strong class="tit_now tit_time">시간</strong>
			<ul id="titTimeList" class="list_option">
				<li #if($StringUtils.equals("$!{command.searchTimeType}","total"))class="on"#end>
					##<button type="button" class="btn_now btn_total">전체</button>
					<input type="radio" name="searchTimeType" value="total" class="screen_out" id="st_t1" onclick="daum.Music.Onair.setSearchTime('st_t1','total','searchChannelForm');" #if($StringUtils.equals("$!{command.searchTimeType}","totla"))checked#end>
					<label class="btn_now btn_total" for="st_t1">전체</label>
				</li>
				<li #if($StringUtils.equals("$!{command.searchTimeType}","am"))class="on"#end>
					##<button type="button" class="btn_now btn_am">오전</button>
					<input type="radio" name="searchTimeType" value="am" class="screen_out" id="st_t2" onclick="daum.Music.Onair.setSearchTime('st_t2','am','searchChannelForm');" #if($StringUtils.equals("$!{command.searchTimeType}","am"))checked#end>
					<label class="btn_now btn_am" for="st_t2">오전</label>
				</li>
				<li #if($StringUtils.equals("$!{command.searchTimeType}","pm"))class="on"#end>
					##<button type="button" class="btn_now btn_pm">오후</button>
					<input type="radio" name="searchTimeType" value="pm" class="screen_out" id="st_t3" onclick="daum.Music.Onair.setSearchTime('st_t3','pm','searchChannelForm');" #if($StringUtils.equals("$!{command.searchTimeType}","pm"))checked#end>
					<label class="btn_now btn_pm" for="st_t3">오후</label>
				</li>
				<li class="screen_out">
					##<button type="button" class="btn_now btn_pm">오후</button>
					<input type="radio" name="searchTimeType" value="custom" class="screen_out" id="st_t4" onclick="daum.Music.Onair.setSearchTime('st_t4','custom','searchChannelForm');" #if($StringUtils.equals("$!{command.searchTimeType}","custom"))checked#end>
					<label class="btn_now btn_pm" for="st_t4">직접입력</label>
				</li>
			</ul>
			<div class="info_filter">
				<div id="track" class="bg_filter bg_bar">
					#set($maxWidth = 192)
					#set($bgOneHW = $MathTool.div($maxWidth,24))
					#set($bgWidth = $MathTool.mul($bgOneHW,$MathTool.sub($!{command.searchETime},$!{command.searchSTime})))
					#set($slideSpx = $MathTool.mul($bgOneHW,$!{command.searchSTime}))
					#set($slideEpx = $MathTool.mul($bgOneHW,$!{command.searchETime}))
					
					<div id="activeBg" class="bg_filter" style="margin-left:$!{slideSpx}px;width:$!{bgWidth}px"></div><!-- 최대 0~193px, margin-left: 슬라이드 범위 최소값, margin-left값+width값 = 슬라이드 범위 최대값 left 값 -->
				</div>
				<div id="sliderHandle1" class="btn_now" style="left:$!{slideSpx}px"></div><!-- 슬라이드 범위 최소값 -->
				<div id="sliderHandle2" class="btn_now" style="left:$!{slideEpx}px"></div><!-- 슬라이드 범위 최대값 -->
			</div>
			<label for="timeStart" class="screen_out">조회 시작 시간</label>
			<input type="text"  id="searchSTimeInp"  name="searchSTime" class="tf_date tf_time" maxlength="2" readonly value="$!{command.searchSTime}">
			<span class="txt_inclusive">-</span>
			<label for="timeEnd" class="screen_out">조회 종료 시간</label>
			<input type="text"  id="searchETimeInp" name="searchETime" class="tf_date tf_time" maxlength="2" readonly value="$!{command.searchETime}">
		</div>								
			
	</div>
		
		
<script type="text/javascript">
    var slider = (function(){
        // 핸들러 ID
        var handleLeftId = "sliderHandle1";
        var handleRightId = "sliderHandle2";


        // 촤우측 이동공간 margin 영역 설정
        var handleLeftScopeStart = 0;
        var handleRightScopeEnd = 192;

        // 시간 기준
        var search_start_Time = 0;
        var search_end_Time = 24;

        // 기타요소 객체
        var track = daum.$("track");
        var activeBg = daum.$("activeBg");
		
		
		// 화면 초기화
        var init = function(){
			daum.Element.setStyle( activeBg,'margin-left:' + handle_1.getPos().left + 'px;'  );
            daum.Element.setWidth( activeBg, handleRightInitPos - handleLeftInitPos );

        };
		
		// 활성화된 배경을 reset
        var resetActiveBg = function(){
            daum.Element.setStyle( activeBg,'margin-left:' + handle_1.getPos().left + 'px;'  );
            daum.Element.setWidth( activeBg, handle_2.getPos().left - handle_1.getPos().left );
        };
		
		// 위치값으로 시간 계산
        var getTimeByPos = function( pos ){
            var distTime = search_end_Time - search_start_Time;
            var distPos = handleRightScopeEnd - handleLeftScopeStart;

            var timePerPixel = distTime / distPos;
            var result = Math.round( search_start_Time + timePerPixel * ( pos - handleLeftScopeStart ) );
			
            return result;
        };
		
		// 시간으로 위치값 계산
        var getPosByTime = function( _time ){
            var distTime = search_end_Time - search_start_Time;
            var distPos = handleRightScopeEnd - handleLeftScopeStart;

            var pixelPerYear = distPos / distTime ;
            var result = Math.round( handleLeftScopeStart + pixelPerYear * ( _time - search_start_Time ) );
			
            return result;
        };
		
		
		
		
		// 초기값 설정
        var handleLeftInitPos = getPosByTime( $!{command.searchSTime} );
        var handleRightInitPos = getPosByTime( $!{command.searchETime} );

        		       
		
        // 좌측 핸들러 정의
        var handle_1 = daum.widget.slider( handleLeftId );
        var handle_2 = daum.widget.slider( handleRightId );
        handle_1.setScopeX({
            init : handleLeftInitPos
        }).addEventListener({
            type : "onMouseDown",
            func : function(){
                handle_1.setScopeX({
                    start : handleLeftScopeStart,
                    end : handle_2.getPos().left
                });
            }
        }).addEventListener({
            type : "onMouseMove",
            func : function(){
				 daum.$('searchSTimeInp').value = getTimeByPos( handle_1.getPos().left );
                resetActiveBg();
            }
        }).addEventListener({
            type : "onMouseUp",
            func : function(){
                //
                daum.$('searchSTimeInp').value = getTimeByPos( handle_1.getPos().left );
                jQuery("#st_t4").click();
				//daum.$('searchChannelForm').submit();

            }
        }).run();
		

        // 우측 핸들러 정의

        handle_2.setScopeX({
            init : handleRightInitPos
        }).addEventListener({
            type : "onMouseDown",
            func : function(){
                handle_2.setScopeX({
                    start : handle_1.getPos().left,
                    end : handleRightScopeEnd
                });
            }
        }).addEventListener({
            type : "onMouseMove",
            func : function(){
				daum.$('searchETimeInp').value = getTimeByPos( handle_2.getPos().left );
                resetActiveBg();
            }
        }).addEventListener({
            type : "onMouseUp",
            func : function(){
                //
                daum.$('searchETimeInp').value = getTimeByPos( handle_2.getPos().left );
                jQuery("#st_t4").click();
				//daum.$('searchChannelForm').submit();

            }
        }).run();


        // 트랙 정의
        daum.Event.addEvent( track, "mousedown", function(e){
            var coords = daum.Element.getCoords( track.id );
            var startX = e.clientX;
            var origX = this.offsetLeft + coords.left;
            var deltaX = startX - origX;

            var hdPos_1 =  handle_1.getPos();
            var hdPos_2 =  handle_2.getPos();

            if( hdPos_1.left > deltaX ){
                deltaX = ( handleLeftScopeStart > deltaX )?handleLeftScopeStart:deltaX;
                handle_1.setPosX( deltaX );
            } else if ( hdPos_2.left < deltaX ) {
                deltaX = ( handleRightScopeEnd < deltaX )?handleRightScopeEnd:deltaX;
                handle_2.setPosX( deltaX );
            } else {
                var center = ( hdPos_1.left + hdPos_2.left ) / 2 ;
                if( center > deltaX ){
                    handle_1.setPosX( deltaX );
                } else {
                    handle_2.setPosX( deltaX );
                }
            }

            resetActiveBg();
			daum.$('searchSTimeInp').value = getTimeByPos( handle_1.getPos().left );
			daum.$('searchETimeInp').value = getTimeByPos( handle_2.getPos().left );
        	jQuery("#st_t4").click();
			//daum.$('searchChannelForm').submit();

        }, false );
		

        // 활성BG 정의
        daum.Event.addEvent( activeBg, "mousedown", function(e){
            var coords = daum.Element.getCoords( activeBg.id );

            var startX = e.clientX;
            var origX = coords.left;
            var deltaX = startX - origX;

            var hdPos_1 =  handle_1.getPos();
            var hdPos_2 =  handle_2.getPos();

            var center = ( coords.right - coords.left ) / 2 ;
            if( center > deltaX ){
                handle_1.setPosX( hdPos_1.left + deltaX );
            } else {
                handle_2.setPosX( hdPos_1.left + deltaX );
            }

            resetActiveBg();
			daum.$('searchSTimeInp').value = getTimeByPos( handle_1.getPos().left );
			daum.$('searchETimeInp').value = getTimeByPos( handle_2.getPos().left );
        	jQuery("#st_t4").click();
			//daum.$('searchChannelForm').submit();


        }, false );
        init();
		

        return {
            reset : function() {
				handleLeftInitPos = getPosByTime(daum.$('searchSTimeInp').value());
                handleRightInitPos = getPosByTime(daum.$('searchETimeInp').value());
                init();
                handle_1.setScopeX({
                    init : handleLeftInitPos
                }).run();
                handle_2.setScopeX({
                    init : handleRightInitPos
                }).run();
            }
        }
    })();
	
</script>
		
		
	<dl class="detail_select">
		<dt class="tit_option">선택된옵션</dt>

		
		
		#if("$!{command.tvChannelType}" =="" && "$!{command.radioChannelType}" =="" && "${command.channelIdsToString()}" == "")
			<dd class="txt_option">채널 전체<span style="color:#000">,</span></dd>
		#end	
		
		#set($channelCount = 0)
        #set($preMediaType = "")
		#foreach($channel in $channelList)
        	#set($checked = false)
        	#foreach($selectedChannel in $command.channelIds)
        		#if($selectedChannel == ${channel.channelId})
        			#set($checked = true)
        			#break
        		#end
			#end
		
		#if($channelCount == 0)

        	#if("$!{command.tvChannelType}" =="1")
				<dd class="txt_option">TV전체<button type="button" class="btn_now btn_delete" onclick="daum.Music.Onair.SearchTimeLine.deleteChannelId('tvChannelType')" >옵션삭제</button></dd>
        	#end
        #end
        	
        #if($channelCount != 0 && $preMediaType != ${channel.mediaType})
			#if("$!{command.radioChannelType}" =="4")
				<dd class="txt_option">Radio전체<button type="button" class="btn_now btn_delete" onclick="daum.Music.Onair.SearchTimeLine.deleteChannelId('radioChannelType')" >옵션삭제</button></dd>
        	#end
        #end	
			
			#if($checked)
				<dd class="txt_option">${channel.channelName}<button type="button" class="btn_now btn_delete" onclick="daum.Music.Onair.SearchTimeLine.deleteChannelId('channelId_$!{channel.channelId}')" >옵션삭제</button></dd>				
			#end
			
			#set($channelCount = $channelCount +1)
        	#set($preMediaType = ${channel.mediaType})	
		#end
		
		#if($StringUtils.isNotBlank($!{command.searchSDate}) && $StringUtils.isNotBlank($!{command.searchEDate}))
			<dd class="txt_option">
				$CheckDate.makeReleaseDate($!{command.searchSDate})-$CheckDate.makeReleaseDate($!{command.searchEDate})#if("$CheckDate.diffOfDate($!{command.searchSDate})" =="0" && "$CheckDate.diffOfDate($!{command.searchEDate})" == "0")<span style="color:#000">,</span>#else<button type="button" class="btn_now btn_delete" onclick="daum.Music.Onair.searchDeleteDate('searchChannelForm')" >옵션삭제</button>#end
			</dd>
		#end
		<dd class="txt_option">
			$!{command.searchSTime}시-$!{command.searchETime}시#if($StringUtils.equals("$!{command.searchTimeType}","total"))#else<button type="button" class="btn_now btn_delete" onclick="daum.Music.Onair.setSearchTime('st_t1','total','searchChannelForm');" >옵션삭제</button>#end
		</dd>
	</dl>
	<a href="/onair/search/channel" class="btn_now btn_initialize">초기화</a>
</div>

</form>	

<div class="searchWrap">
<h4 class="screen_out">곡 리스트</h4>
<div id="searchSongListWrap">
#if(!$CollectionUtils.isEmpty($schduleKeyList))

	#foreach($schduleKey in $schduleKeyList)
		
		<div class="opt_date opt_timeline">
        	<div class="date_cont">
        		<span class="screen_out">$schduleKey</span>
        		<span class="txt_date txt_num$!schduleKey.substring(0,1)"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(1,2)"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(2,3)"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(3,4)"></span>
        		<span class="txt_date txt_dot"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(4,5)"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(5,6)"></span>
        		<span class="txt_date txt_dot"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(6,7)"></span>
        		<span class="txt_date txt_num$!schduleKey.substring(7,8)"></span>
        		<span class="txt_date txt_$CheckDate.getDayEngNameByDate("$!schduleKey")"></span>
        	</div>
        </div>
		

		
		#set($channelSongListByDate = ${channelSongMap.get($schduleKey)})
		
		#if(!$CollectionUtils.isEmpty($channelSongListByDate))
		#set($heightList = $MathTool.mul($channelSongListByDate.size(),68))
		<div id="$!{schduleKey}_timelinelistWrap" class="now_musiclist now_timelist" style="height:$!{heightList}px">
            	<!--68px 단위로 더보기 클릭시 리스트 늘어남-->
            	<div class="timeline_slide" style="top:0px">
            		<!--68px 단위로 슬라이드-->
            		<table class="tbl_now">
            			<caption class="screen_hide">방금 그곡 리스트</caption>
            			<colgroup>
            				<col style="width:57px">
            				<col style="width:79px">
            				<col style="width:300px">
            				<col style="width:auto">
            				<col style="width:234px">
            			</colgroup>
            			<thead class="screen_out">
            				<tr>
            					<th scope="col">방송시간</th>
            					<th scope="col">앨범</th>
            					<th scope="col">곡명, 아티스트</th>
            					<th scope="col">채널, 프로그램</th>
            					<th scope="col">구매하기</th>
            				</tr>
            			</thead>
            			<tbody id="$!{schduleKey}_timelinelist">
            				#foreach($channelSong in $channelSongListByDate)
            				#set($count = $count + 1)
            				<tr #if("$!{channelSong.hotYn}" == "Y" && "$!{channelSong.copy}" != "")class='tr_special'#end>
            					<td class="td_clock"><span class="ico_now ico_clock" data-time="$!{channelSong.startTime}">$!{channelSong.startTime.substring(8,10)}:$!{channelSong.startTime.substring(10,12)}</span></td>
            					<td class="td_album">
            							#if("$!{channelSong.hotYn}" == "Y" && "$!{channelSong.copy}" != "" && "$!{channelSong.hotIconImage}" != "")
            								#set($linkSpecialCn = "link_special")
            							#else
            								#set($linkSpecialCn = "")
            					        #end
            						
            							#if("$!{channelSong.song.album.albumId}" != "0")
            						<a href="/album/main?album_id=${channelSong.song.album.albumId}" class="link_album $!{linkSpecialCn}">
            							#else
            						<em href="#none" class="link_album $!{linkSpecialCn}">
            							#end
            							
            							#if("$!{channelSong.hotYn}" == "Y" && "$!{channelSong.copy}" != "" && "$!{channelSong.hotIconImage}" != "")
            								<img src="$!{channelSong.hotIconImage}" width="66" height="60" class="thumb_album" alt="HOT">												
            							#else
            								
            								#if("$!{channelSong.hotYn}" == "Y" && "$!{channelSong.copy}" != "")
            									<em class="ico_now ico_hot">Hot</em>
            								#end
            									
            								#if("$!{channelSong.song.album.albumId}" != "0" && "$!{channelSong.song.songId}" != "0" && "$!{channelSong.song.album.mainImage.filePath}" != "")
            								<img src='$ImageUtil.getImageUrl("$!{channelSong.song.album.mainImage.filePath}", "42x42", "ALBUM", "C")' width="42" height="42" class="thumb_album" alt="#strCut(${channelSong.song.title}, 10, "..")">
            								#else
            								<img src="http://i1.daumcdn.net/img-contents/music/2011_home/common/noalbum_42_42.gif" width="42" height="42" class="thumb_album" alt="#strCut(${channelSong.title}, 10, "..")">
            								#end
            								<span class="frame_g"></span>	
            							#end	
            							
            							#if("$!{channelSong.song.album.albumId}" != "0")
            						</a>
            							#else
            						</em>
            							#end
            					</td>
            					<td class="td_song">
            						<span class="txt_desc">
            							#set($className = "")
            							#if("$!{channelSong.song.songId}" != "0" && "${channelSong.song.AODLinkId}" != "" && "${channelSong.song.AODLinkId}" != "0")
            								#set($className = "link_song")	
            							#end
            							#if("$!{channelSong.song.songId}" != "0")#printSongName($!{channelSong.song} $className 35 true)#else<em class="link_song">#strCut(${channelSong.title}, 35)</em>#end
            						</span>
            						#if("$!{channelSong.hotYn}" == "Y" && "$!{channelSong.copy}" != "")
            							<span class="txt_special">$!{channelSong.copy}</span>
            						#else
            							#if("$!{channelSong.song.songId}" != "0")
            								#set($artistCount = 0)
            								#set($etcArtistCount = 0)
            								#foreach($songArtist in $!{channelSong.song.keyArtistList})
            									#set($artistCount = $artistCount +1)
            									#set($strCutLen = 17)
            									#if($!{channelSong.song.keyArtistList.size()} == 1)
            										#set($strCutLen = 35)
            									#end
            									#if("$!{songArtist.artistId}" != "0")
            										<a href="/artist/main?artist_id=${songArtist.artistId}" class="link_artist">#strCut(${songArtist.name}, $strCutLen, "..")</a>
            									#else
            										#strCut(${songArtist.name}, $strCutLen, "..")
            									#end
            									#if($artistCount < $!{channelSong.song.keyArtistList.size()} && $artistCount < 2),#end
            									#if($artistCount == 2) #set($etcArtistCount = $!{channelSong.song.keyArtistList.size()} - 2) #break #end
            								#end
            								#if($etcArtistCount > 0)
            								외 ${etcArtistCount}명
            								#end
            							#else
                            			 <em href="#none" class="link_artist">#strCut($!{channelSong.artistName}, 35, "..")</em>
            							#end
            						#end
            					</td>
            					<td class="td_program">
            						<span class="txt_desc"><a href="/onair/search/channel?searchSDate=$!{channelSong.startTime.substring(0,8)}&searchEDate=$!{channelSong.startTime.substring(0,8)}&channelIds=${channelSong.channel.channelId}" class="link_channel">${channelSong.channel.channelName}</a></span>
            						#if("$!{channelSong.schedule.programId}" != "" && "$!{channelSong.schedule.programId}" != "0" && "$!{channelSong.channel.mediaType}" == "1")
            						<a href="/onair/tv?programId=${channelSong.schedule.programId}#nowMusicListWrap" class="link_program">${channelSong.schedule.programName}</a> <!-- a태그 em으로 변경시 딤드 처리 -->
            						#elseif("$!{channelSong.schedule.programId}" != "" && "$!{channelSong.schedule.programId}" != "0" && "$!{channelSong.channel.mediaType}" == "4")	
            						<a href="/onair/radio/channel?channelId=${channelSong.channel.channelId}&programId=${channelSong.schedule.programId}#nowMusicListWrap" class="link_program">${channelSong.schedule.programName}</a> <!-- a태그 em으로 변경시 딤드 처리 -->
            						#else	
            						<em href="#none" class="link_program">${channelSong.schedule.programName}</em>
            						#end
            						
            					</td>
            					<td class="td_option">
            						#printListItemButtonOnair(${channelSong.song.songId}, "listen", "", ${channelSong.song.AODLinkId})
            						#printListItemButtonOnair(${channelSong.song.album.albumId}, "album", "")
            						#printListItemButtonOnair(${channelSong.song.songId}, "my", "", ${channelSong.song.AODLinkId})
            						#printListItemButtonOnair(${channelSong.song.songId}, "mp3", "", ${channelSong.song.MP3LinkId})
            						#printListItemButtonOnair(${channelSong.song.songId}, "bgm", "", ${channelSong.song.BGMLinkId})
            					</td>
            				</tr>
                        	#if($count == ${songList.size()})
                        		#set($songEndTime = ${channelSong.startTime})	
                        	#end
            			#end
    	
						</tbody>
            		</table>
            	</div>
            </div>
			
		#end
        	
	#end
	</div>
	<a href="#none" class="btn_more" onclick="daum.Music.Onair.SearchTimeLine.getBottomSongList();"><span class="btn_now txt_more">더보기</span></a>	
#else		
	<h4 class="screen_out">검색결과</h4>
    <div class="wrap_noresult">
		<strong class="tit_noresult"><span class="emph_noresult">검색결과가 없습니다</span></strong>
    	<ul class="list_noresult">
    		<li>· 날짜, 시간 범위를 더 넓혀주세요.</li>
    	</ul>
     </div>
	
#end
	

</div>


#parse("/velocity/onair/common/specialbanner.vm") 
#parse("/velocity/onair/common/programChart.vm")


<script type="text/javascript">
// 달력 
var changeRadioButton = function(){

	jQuery("#sh_t5").click();
}

// 레이어 달력	
var calendarLayer = new daum.Music.OnairSearchCalendar(
	{
		//selectedDay : "$!{command.searchDate}",
		startDateElId : "dateStart",
		endDateElId : "dateEnd",
		startCalContainerId : "startCalwrap",
		endCalContainerId : "endCalwrap",
		useScheduleDays : false,
		selectDateAddFunc : changeRadioButton,
		minDay : "$!minDay"
	}
);



var tvChannelType="$!{command.tvChannelType}";
var radioChannelType="$!{command.radioChannelType}";
var selectedChannelIds = [];
#foreach($selChannel in $!{command.channelIds})
selectedChannelIds.push("${selChannel}");
#end
selectedChannelIds.join("",",");
	
var nextPageNo = $!{command.pageNo}+1;
	var totalPage = $!totalPage;
	var option = {
		 nextPageNo : nextPageNo,
		 tvChannelType : tvChannelType,
		 radioChannelType : radioChannelType,
		 selectedChannelIds : selectedChannelIds,
		 searchSDate : "$!{command.searchSDate}",
		 searchEDate : "$!{command.searchEDate}",
		 searchSTime : "$!{command.searchSTime}",
		 searchETime : "$!{command.searchETime}",
		 totalCnt : $!totalCnt,
		 totalPage : $!totalPage,
		 searchSongListWrapId : "searchSongListWrap",
		 type : "channel"
	};

	jQuery("document").ready(
	function(){
    	new daum.Music.Onair.SearchTimeLine.init(option);
		
		jQuery(".list_chice li .btn_now").click(daum.Music.Onair.SearchTimeLine.selectChannelId);
	});	
	
	
	var controller = new daum.Music.ListPrototype();
	controller.initialize();  
</script>






#if( $StringUtils.equals("$!{command.debugmode}","2") )
#set($date = $!{command.searchDate})
searchDate : $!searchDate </br>
date : $!date </br>
searchSDate : $!{command.searchSDate} </br>
searchEDate : $!{command.searchEDate} </br>
earchDueType : $!{command.SearchDueType} </br>
programName : $!{command.programName} </br>
totalcnt : $!{totalCnt} </br>
totalPage : $!{totalPage} </br>
pageNo : $!{command.pageNo} </br>
</br>

채널리스트</br>
#set($channelCount = 0)
#set($preMediaType = "")
#foreach($channel in $channelList)

	#if("$preMediaType" != "${channel.mediaType}")
		${channel.mediaType}	</br>
	#end	
		${channel.channelName} </br>
						

	#set($preMediaType = ${channel.mediaType})
#end
</br>
</br>
스케줄리스트 </br>
#foreach($schduleKey in $schduleKeyList)
	$schduleKey </br>
	
	#set($channelSongListByDate = ${channelSongMap.get($schduleKey)})
    곡리스트 : $channelSongListByDate.size()</br>
	#foreach($channelSong in $channelSongListByDate)
    	$channelSong.title </br>
    #end	
#end


</br>
선택된 채널리스트
#foreach($channel in $command.channelIds)
	$channel
#end	

#end

