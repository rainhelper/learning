#set($tmpTicketOwnCount = $dto.ticketOwnCount - 1)
#set($targetService = $command.getTarget_service())
#if($targetService == "BLOG") 
	#set ($sidx = 1)
#else 
	#set ($sidx = 0)
#end
#if( $command.getTarget_service() == "CAFE"  && $cafeInfoList.size()==0 )
	#set( $noData = true )
#end	
#if( $command.getTarget_service() == "BLOG" && $StringUtils.isEmpty("$!{bgmStatus.blogUrl}") )
	#set( $noData = true )
#end	
#if( $command.getTarget_service() == "KIDS" && $StringUtils.isEmpty("$!{bgmStatus.kidsUrl}") )
	#set( $noData = true )
#end

<style type="text/css">
	#daumIndex {display:none;}
	.lst .artiTxt .artist .f_l {float:none;}
	#wBGMCafeService .sch, #wBGMCafeService .srt {vertical-align:top;}
	#wBGMCafeFrdService .sch, #wBGMCafeFrdService .srt {vertical-align:top;}
</style>
<div id="Daum_doc">
<div id="wUse">	
	<div#if($targetService=="KIDS") id="wBGMKidsService"#else id="wBGMCafeService"#end>
		<div id="wBGMCafe">
		#if(!$noData)
		<form name="inputform" onsubmit="return false;">
			<input type="hidden" name="target_service" value="$!targetService"> 
			#if($targetService == "CAFE")	
    			<input type="hidden" name="group_id" value="$!{cafeGroupId}">
    			<input type="hidden" name="node" value="$!{cafeNode}">
			#elseif($targetService == "KIDS")
				<input type="hidden" name="page_type" value="iframe">
			#end
			#if($targetService == "KIDS")
        		<div class="clearfix titCon">
        			<div class="fl rdo"><input type="radio" id="bgmUseY" name="use_yn" value="Y" #if("$!{bgmStatus.useYN}" == "Y") checked #end><label for="bgmUseY">배경음악 사용함</label><input type="radio" id="bgmUseN" name="use_yn" value="N" #if("$!{bgmStatus.useYN}" == "N") checked #end><label for="bgmUseN">배경음악 사용안함</label></div>
        		</div>
        	#else
        		<div class="clearfix titCon">
        			<h5 class="fl tit">배경음악 편집하기</h5>
        			<div class="fl rdo"><input type="radio" id="bgmUseY" name="use_yn" value="Y" #if("$!{bgmStatus.useYN}" == "Y") checked #end><label for="bgmUseY">배경음악 사용함</label><input type="radio" id="bgmUseN" name="use_yn" value="N" #if("$!{bgmStatus.useYN}" == "N") checked #end><label for="bgmUseN">배경음악 사용안함</label></div>
        		</div>
        	#end
			<div class="ctlCon">
				<div class="controlBgm">
					<div class="fl leftArea">
						<div class="sch">
##							<select id="schType" class="fl">
##								<option value="BGM">보유곡만</option>
##								<option value="">전체곡</option>
##							</select>
							<input type="text" class="inp fl" value="" id="songKeyword" onKeypress="if(event.keyCode==13){BGMList.goSearch();return false;}">
							<input type="button" class="fl typeBtn btnSearchBgm" value="검색" onclick="BGMList.goSearch();return false;">
        				</div>
						<div class="srt clearfix">
							<div class="fl">
								<strong id="schTypeTit"#if($targetService == "KIDS") class="ls_m1"#end>보유곡</strong><span id="schTot"><span class="bar">|</span>총 <span id="totCnt" class="em">0</span>곡</span>
							</div>
							<div id="totSort" style="display:block;">
								<div class="fr sort">
									<a href="javascript:;" onclick="BGMList.goSort(1);" id="sort1" class="blue_d1" title="최신구매순으로 보기">최신구매순</a>
									<span class="bar">|</span>
									<a href="javascript:;" onclick="BGMList.goSort(2);" id="sort2" class="" title="가나다순으로 보기">가나다순</a>
								</div>
							</div>
							<div id="schSort" style="display:none;">
								<div class="fr sort"><a href="javascript:;" onclick="BGMList.goRefrash();" class="blue_d1" title="보유곡 보기">보유곡 목록</a></div>
							</div>
						</div>
						<div id="listBox" class="lstBox"><!-- bgm list --></div>
						<div id="pageBox" class="cPaging"><!-- page --></div>
    				</div>
					
					<input type="button" class="typeBtn btBgmPut" value="넣기" onclick="BGMList.transfer();">
					<input type="button" class="typeBtn btBgmGet" value="빼기" onclick="BGMList.goMove('del');">
				
					<div class="fr rightArea">
						<div class="sch fs_small gray ls_m1">
							곡명 더블클릭으로 넣기/빼기를 편하게 해보세요.
						</div>
						<div class="srt clearfix">
							<div class="fl">
								<strong>선택곡</strong><span class="bar">|</span><span id="selCnt" class="em">0</span>/<span id="maxCnt">0</span>곡
							</div>
						</div>
						<div id="selectBox" class="lstBox">
							<!-- bgm select list -->
						</div>
						<div class="moveArea">
							
							<p class="fl">
								#if($targetService == "KIDS" || $StringUtils.equals("$!{cafeNode}","friends"))
									<input type="hidden" name="shuffle_yn" value="N">
								#else<input type="checkbox" name="shuffle_yn" value="Y" #if("$!{bgmStatus.shuffleYN}" == "Y") checked #end id="randomPlay"> <label for="randomPlay">랜덤 플레이</label>#end
							</p>
							<div class="fr">
								<input class="typeBtn btBgmMove btBgmMoveBottom" type="button" onclick="BGMList.goMove('bottom');" value="맨 아래로 이동"/>
								<input class="typeBtn btBgmMove btBgmMoveDown" type="button" onclick="BGMList.goMove('down');" value="아래로 이동"/>
								<input class="typeBtn btBgmMove btBgmMoveUp" type="button" onclick="BGMList.goMove('up');" value="위로 이동"/>
								<input class="typeBtn btBgmMove btBgmMoveTop" type="button" onclick="BGMList.goMove('top');" value="맨 위로 이동"/>
							</div>
							</div>
						</div>
					</div>
					<div id="daumAodLuncherWrap"></div>
					<script type="text/javascript">initAodLauncher('daumAodLuncherWrap');</script>

					<script type="text/javascript">
						daum.Event.addEvent(window, "load",  function(){
							daumMusic.JsPlayer.embedSWF( "flashContainer", null, daum.Music.BitPlayer.stop );
						});

						var myBgmList = [
        				#foreach($play in $bgmStatus.playlist)
        					{BgmTrackId:"$!{play.bgmTrackId}",SongId:"$!{play.songId}",Title:"$!{StringCutUtil.removeCarriageReturn($!{StringCutUtil.removeTagJSON($!{play.title})})}",ArtistName:"$!{StringCutUtil.removeCarriageReturn($!{StringCutUtil.removeTagJSON($!{play.artist})})}", IsOwn:("$command.getTarget_service()" == "CAFE" && "$!play.userId" == "$!{userInfo.userId}")}#if($velocityHasNext),#end
        				#end
						];
						#if($StringUtils.equals("$!{cafeNode}","friends"))
                    	var _service = "CAFEFRIENDS";
                    	#else
                    	var _service = "$!{targetService}";
                    	#end
						var BGMList = new Music.BGMSetup(myBgmList, _service);
					</script>
				</div>
				<div class="btnArea clearfix">
					<input type="button" class="typeBtn btnSubmit" value="등록하기" onclick="BGMList.goSubmit(); return false;">
##					<input type="button" class="typeBtn btnMusic" value="Daum뮤직 바로가기" onclick="window.open('http://music.daum.net');">
				</div>
			</form>
#else	## list view 
	#if($targetService == "CAFE")
			<div class="serviceNone">
				<p>카페지기나 운영자로 활동하고 계신 카페가 없습니다.</p>
				<input type="button" class="typeBtn btnMyCafeLst" value="내 카페 목록 확인하기" onclick="window.open('http://cafe.daum.net/_c21_/mine_main?t__nil_loginbox=cafelist');">
			</div>
	#elseif($targetService == "KIDS")
			<div class="serviceNone">
				<p>개설하신 마이짱이 없습니다.</p>
				<input type="button" class="typeBtn btnMakeKids" value="키즈짱 가기" onclick="window.open('http://my.kids.daum.net/myzzang/do/profile/joinForm');">
			</div>
	#else		## BLOG
			<div class="serviceNone">
				<p>개설하신 블로그가 없습니다.</p>
				<input type="button" class="typeBtn btnMakeBlog" value="블로그 가기" onclick="window.open('http://blog.daum.net/_blog/_top/sub/makeBlogEnter.do');">
			</div>
	#end
#end
		</div>
	</div>
	#*
	#if($targetService != "KIDS")
	<div id="wBgmRecom2">
	<div id="wTopBgm" class="recomBox">
		<div class="titCon">
			<h4 class="fl">배경음악 인기순위</h4>
			<a href="http://music.daum.net/chart/chartsong/list?genre_cd=TORA&date_key=4" target="_blank" class="fr more" title="배경음악 인기순위 더보기">더보기</a>
		</div>
		<ol class="lst">
			#foreach($song in $chartSongFive)
				#set($lyricHref = "/album/main?album_id=$!song.album.albumId&song_id=$!song.songId#viewLyrics")
				#set($bgmHref = "/purchase/cart/bgmadd.popup?song_id_list=$!song.songId")
				#set($id = $song.songId)
				<li class="no$!{song.rank}">
					<span class="fl songTxt">#printSongName( $song "" 26 true false false)</span>
					<div class="fl artiTxt">
						<div class="ellipsis" style="width:90px;">
							<span class="artist">
								#set($cutLen = 10)
								#foreach($keyArtist in $song.keyArtistList)
									<a href="http://music.daum.net/artist/main?artist_id=$keyArtist.artistId" target="_blank" title="#escTitle($keyArtist.name)">#strCut($keyArtist.name, $cutLen)</a>#if($cutLen <= 0)#break#elseif($velocityHasNext), #end
									#set($cutLen = $cutLen - $StringCutUtil.getStringByte($keyArtist.name) - 2)
								#end
							</span>
						</div>
					</div>
					#set($value = $song.lyricsYn)
					<a class="typeBtn btSetList btListLyrics#if($value!="Y")_dis#end" #if($value != "Y")  title="가사 등록"#else title="가사 보기"#end href="$!lyricHref" target="_blank" >가</a>## 가사가 없으면 dimd만 시키고 링크는 그대로 유지
						#set($value = $song.BGMLinkId)
					<input type="button" class="typeBtn btSetList btListBgm#if(!$id||!$value)_dis#end" #if(!$id||!$value)disabled#end id="bgm_$!{id}" onclick="daum.Browser.popup('$!bgmHref', 765, 550);">##
				</li>
			#end
		</ol>
	</div>
	<div id="wRecBgm" class="recomBox">
		<div class="titCon">
			<h4 class="fl">추천 배경음악</h4>
			<a href="http://music.daum.net/chart/chartsong/list?date_key=4&date=2011022001&genre_cd=OSRA" target="_blank" class="fr more" title="추천 배경음악 더보기">더보기</a>
		</div>
		<ul class="lst">
#foreach($song in $chartOstFive)
				#set($lyricHref = "/album/main?album_id=$!song.album.albumId&song_id=$!song.songId#viewLyrics")
				#set($bgmHref = "/purchase/cart/bgmadd.popup?song_id_list=$!song.songId")
				#set($id = $song.songId)
				<li class="no$!{song.rank}">
					<span class="fl songTxt">#printSongName( $song "" 26 true false false )</span>
					<div class="fl artiTxt">
						<div class="ellipsis" style="width:90px;">
							<span class="artist">
								#set($cutLen = 10)
								#foreach($keyArtist in $song.keyArtistList)
									<a href="http://music.daum.net/artist/main?artist_id=$keyArtist.artistId" target="_blank" title="#escTitle($keyArtist.name)">#strCut($keyArtist.name, $cutLen)</a>#if($cutLen <= 0)#break#elseif($velocityHasNext), #end
									#set($cutLen = $cutLen - $StringCutUtil.getStringByte($keyArtist.name) - 2)
								#end
							</span>
						</div>
					</div>
					#set($value = $song.lyricsYn)
					<a class="typeBtn btSetList btListLyrics#if($value!="Y")_dis#end" #if($value != "Y")  title="가사 등록"#else title="가사 보기"#end href="$!lyricHref" target="_blank" >가</a>## 가사가 없으면 dimd만 시키고 링크는 그대로 유지
						#set($value = $song.BGMLinkId)
					<input type="button" class="typeBtn btSetList btListBgm#if(!$id||!$value)_dis#end" #if(!$id||!$value)disabled#end id="bgm_$!{id}" onclick="daum.Browser.popup('$!bgmHref', 765, 550);">##
				</li>
#end
		</ul>
	</div>
	</div>
	#end
	*#
</div>
<div id="flashContainer"></div>
<script type="text/javascript">
	
	if(document.body.offsetWidth < 799 && daum.$("wBGMCafeService")){
		daum.$("wBGMCafeService").id = "wBGMCafeFrdService";
		daum.$("wBgmRecom2").id = "wBgmRecom3";
	}
</script>

#if( $StringUtils.equals("$!{command.debugmode}","2") )
		
배경음악관리<br/> 
현재보고있는부분: $command.getTarget_service() <br/><br/> 

#if( $command.getTarget_service() == "CAFE")
	카페지기/운영자로 활동하는 카페<br/>
		#foreach($cafeInfo in $cafeInfoList)
			 $cafeInfo.groupId || $cafeInfo.groupName || $cafeInfo.node <br/>
		#end

	화면에 보이는 카페링크 : $cafeLinkUrl || $cafeNode || 	$bgmStatus.useYN || $cafeGroupId <br/>
	
#end	

<strong>BGM플레이리스트</strong><br/>
	#foreach($play in $bgmStatus.playlist)
		아이디: ${play.bgmTrackId}<br/> 
		곡아이디: ${play.songId}<br/> 
		타이틀: ${play.title}<br/>
		아티스트 : ${play.artist}<br/>
	--------------------------------------<br/>
	#end<br/>	

#if( $command.getTarget_service() == "BLOG")
	블로그URL : $bgmStatus.blogUrl || $bgmStatus.useYN <br/>
#end

	셔플 : $bgmStatus.shuffleYN <br/>	
<br/>		

배경음악 인기순위<br/> 		
#foreach($bgmRanking in $bgmRankingList)
	$bgmRanking.rank || $bgmRanking.songId || $bgmRanking.title  || $bgmRanking.lyricsYn || $bgmRanking.BGMLinkId ||
	
	#foreach($artist in $bgmRanking.keyArtistList)
		아티스트명 : $artist.name || $artist.artistId<br/>
	#end

	#foreach($artist in $bgmRanking.featArtist)
		피처링아티스트명 : $artist.name || $artist.artistId<br/>
	#end 
#end
요즘 뜨는 노래<br/>
#foreach($daumRanking in $daumRankingList)
	$daumRanking.rank || $daumRanking.songId || $daumRanking.title || $daumRanking.lyricsYn || $daumRanking.BGMLinkId ||
	
	#foreach($artist in $daumRanking.keyArtistList)
		아티스트명 : $artist.name || $artist.artistId<br/>
	#end

	#foreach($artist in $daumRanking.featArtist)
		피처링아티스트명 : $artist.name || $artist.artistId<br/>
	#end 
#end
================================================================ <br/>	
		
CAFE regist parameter : target_service=CAFE&group_id={groupId}&node={node}&use_yn={useYN}&shuffle_yn={shuffleYN}&bgmTrack_id={bgmTrackId} <br>
BLOG parameter : target_service=BLOG&use_yn={useYN}&shuffle_yn={shuffleYN}&bgmTrack_id={bgmTrackId}

#end
